<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>الحمية الغذائية - أبو معتصم الغالي</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f7f7f7; direction: rtl; }
    h1 { color: #333; text-align: center; margin-bottom: 5px; }
    .quote { text-align: center; font-style: italic; color: #555; margin-bottom: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    select, button { width: 100%; padding: 10px; margin: 10px 0; font-size: 16px; }
    .result, .all-meals { margin-top: 20px; background: #eef; padding: 15px; border-radius: 6px; font-size: 18px; min-height: 50px; }
    .all-meals { background: #fffbe6; border: 1px solid #ddd; }
    .meal-label { font-weight: bold; margin-top: 10px; display: block; }
  </style>
</head>
<body>
  <div class="container">
    <h1>الحمية الغذائية - أبو معتصم الغالي</h1>
    <div class="quote" id="dailyQuote"></div>

    <label for="day">اختر اليوم:</label>
    <select id="day">
      <option value="">-- اختر اليوم --</option>
      <option>السبت</option>
      <option>الأحد</option>
      <option>الاثنين</option>
      <option>الثلاثاء</option>
      <option>الأربعاء</option>
      <option>الخميس</option>
      <option>الجمعة</option>
    </select>

    <label for="meal">اختر الوجبة (أو اتركها فارغة لعرض جميع الوجبات):</label>
    <select id="meal">
      <option value="">-- جميع الوجبات --</option>
      <option>فطور</option>
      <option>وجبة خفيفة 1</option>
      <option>غداء</option>
      <option>وجبة خفيفة 2</option>
      <option>عشاء</option>
      <option>بعد العشاء</option>
    </select>

    <button onclick="handleDisplay()">عرض</button>

    <div class="result" id="mealResult"></div>
    <div class="all-meals" id="allMealsResult"></div>
  </div>

  <script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/14gQEIbO44LevNhvrWV1tn8bYjvwyhG63hTSatC8WTw8/gviz/tq?tqx=out:json';
    let meals = {};
    const daysMap = ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'];

    const quotes = [
      "الصحة تاج على رؤوس الأصحاء لا يراه إلا المرضى.",
      "جسمك هو بيتك الحقيقي، فحافظ عليه كما تحافظ على أغلى ممتلكاتك.",
      "ابدأ يومك بأكل صحي، واحصد يومًا مليئًا بالطاقة والإيجابية.",
      "العقل السليم في الجسم السليم، والغذاء المتوازن هو مفتاح كليهما.",
      "الوقاية خير من العلاج، والغذاء الصحي أول خطوات الوقاية.",
      "دع طعامك يكون دواءك، ودواءك يكون طعامك. – أبقراط",
      "الطعام الجيد يصنع يومًا جيدًا، واليوم الجيد يصنع حياة أفضل.",
      "من يتحكم في طعامه، يتحكم في صحته وسعادته."
    ];

    document.getElementById('dailyQuote').textContent = `"${quotes[Math.floor(Math.random() * quotes.length)]}"`;

    fetch(sheetURL)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        rows.forEach(row => {
          const day = row.c[0]?.v?.trim();
          if (!day) return;

          meals[day] = {
            'فطور': row.c[1]?.v || '',
            'وجبة خفيفة 1': row.c[2]?.v || '',
            'غداء': row.c[3]?.v || '',
            'وجبة خفيفة 2': row.c[4]?.v || '',
            'عشاء': row.c[5]?.v || '',
            'بعد العشاء': row.c[6]?.v || ''
          };
        });

        setTodayDefault();
      });

    function setTodayDefault() {
      const todayIndex = new Date().getDay();
      const todayArabic = daysMap[todayIndex];
      document.getElementById('day').value = todayArabic;
    }

    function handleDisplay() {
      const meal = document.getElementById('meal').value;
      if (meal === '') {
        showAllMeals();
      } else {
        showMeal();
      }
    }

    function showMeal() {
      const day = document.getElementById('day').value;
      const meal = document.getElementById('meal').value;
      const resultDiv = document.getElementById('mealResult');
      const allMealsDiv = document.getElementById('allMealsResult');
      allMealsDiv.innerHTML = '';

      if (day && meal && meals[day] && meals[day][meal]) {
        resultDiv.textContent = `${meal} في ${day}: ${meals[day][meal]}`;
      } else {
        resultDiv.textContent = "يرجى اختيار يوم ووجبة صحيحة أو قد تكون البيانات غير متوفرة بعد.";
      }
    }

    function showAllMeals() {
      const day = document.getElementById('day').value;
      const resultDiv = document.getElementById('mealResult');
      const allMealsDiv = document.getElementById('allMealsResult');
      resultDiv.textContent = '';
      allMealsDiv.innerHTML = '';

      if (day && meals[day]) {
        let content = `<h3>جميع الوجبات ليوم ${day}</h3>`;
        for (const [mealType, description] of Object.entries(meals[day])) {
          content += `<div><span class="meal-label">${mealType}:</span> ${description}</div>`;
        }
        allMealsDiv.innerHTML = content;
      } else {
        allMealsDiv.innerHTML = "يرجى اختيار يوم صحيح أو قد لا تتوفر البيانات.";
      }
    }
  </script>
</body>
</html>
