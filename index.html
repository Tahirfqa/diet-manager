<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>الحمية الغذائية - أبو معتصم الغالي</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background-color: #f9f9f9;
      padding: 20px;
      direction: rtl;
      text-align: right;
    }
    header {
      background-color: #0077b6;
      color: white;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      margin-bottom: 20px;
    }
    .quote {
      font-style: italic;
      color: #555;
      text-align: center;
      margin-bottom: 30px;
    }
    select, button {
      font-size: 1em;
      padding: 8px;
      margin: 5px 0;
      width: 100%;
      max-width: 300px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #0077b6;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #005f8e;
    }
    .meal-box {
      background-color: #ffffff;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 15px;
      margin-top: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .meal-box div {
      margin-bottom: 15px;
      border-bottom: 1px dashed #ccc;
      padding-bottom: 10px;
    }
    .meal-box div:last-child {
      border-bottom: none;
    }
    footer {
      margin-top: 40px;
      text-align: center;
      color: #888;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <header>
    <h1>الحمية الغذائية - أبو معتصم الغالي</h1>
  </header>

  <div class="quote" id="dailyQuote"></div>

  <label for="day">اختر اليوم:</label>
  <select id="day"></select>

  <label for="meal">اختر الوجبة (اختياري):</label>
  <select id="meal">
    <option value="">كل الوجبات</option>
    <option value="فطور">فطور</option>
    <option value="وجبة خفيفة 1">وجبة خفيفة 1</option>
    <option value="غداء">غداء</option>
    <option value="وجبة خفيفة 2">وجبة خفيفة 2</option>
    <option value="عشاء">عشاء</option>
  </select>

  <button onclick="showMeal()">عرض</button>

  <div class="meal-box" id="mealResult"></div>

  <footer>تم إعداد هذا البرنامج بكل حب لأبو معتصم ❤️</footer>

  <script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/14gQEIbO44LevNhvrWV1tn8bYjvwyhG63hTSatC8WTw8/gviz/tq?tqx=out:json';

    const wisdoms = [
      "الصحة تاج على رؤوس الأصحاء لا يراه إلا المرضى.",
      "ابدأ يومك بأكل صحي، واحصد يومًا مليئًا بالطاقة.",
      "العقل السليم في الجسم السليم، والغذاء المتوازن هو مفتاح كليهما.",
      "من يتحكم في طعامه، يتحكم في صحته وسعادته.",
      "الوقاية خير من العلاج، والغذاء الصحي أول خطوات الوقاية.",
      "دع طعامك يكون دواءك، ودواءك يكون طعامك. – أبقراط"
    ];
    document.getElementById("dailyQuote").textContent = wisdoms[Math.floor(Math.random() * wisdoms.length)];

    const meals = {};
    const days = ["السبت", "الأحد", "الاثنين", "الثلاثاء", "الأربعاء", "الخميس", "الجمعة"];
    const mealTypes = ["فطور", "وجبة خفيفة 1", "غداء", "وجبة خفيفة 2", "عشاء"];

    const daySelect = document.getElementById("day");
    days.forEach(day => {
      const option = document.createElement("option");
      option.value = day;
      option.textContent = day;
      daySelect.appendChild(option);
    });

    // تحديد اليوم الحالي تلقائيًا
    const todayIndex = new Date().getDay(); // 0 = Sunday
    const arabicDay = days[(todayIndex + 6) % 7]; // تحويل إلى بداية الأسبوع العربي (السبت)
    daySelect.value = arabicDay;

    fetch(sheetURL)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        rows.forEach(row => {
          const day = row.c[0]?.v;
          if (!day) return;
          meals[day] = {
            "فطور": (row.c[1]?.v || '').trim(),
            "وجبة خفيفة 1": (row.c[2]?.v || '').trim(),
            "غداء": (row.c[3]?.v || '').trim(),
            "وجبة خفيفة 2": (row.c[4]?.v || '').trim(),
            "عشاء": (row.c[5]?.v || '').trim()
          };
        });
      });

    function showMeal() {
      const selectedDay = document.getElementById("day").value;
      const selectedMeal = document.getElementById("meal").value;
      const resultDiv = document.getElementById("mealResult");
      resultDiv.innerHTML = "";

      if (!meals[selectedDay]) {
        resultDiv.textContent = "لا توجد بيانات لهذا اليوم.";
        return;
      }

      if (selectedMeal && meals[selectedDay][selectedMeal]) {
        resultDiv.innerHTML = `<div><strong>${selectedMeal}:</strong><br>${meals[selectedDay][selectedMeal].replace(/\n/g, "<br>")}</div>`;
      } else {
        mealTypes.forEach(type => {
          const content = meals[selectedDay][type];
          if (content) {
            resultDiv.innerHTML += `<div><strong>${type}:</strong><br>${content.replace(/\n/g, "<br>")}</div>`;
          }
        });
      }
    }
  </script>
</body>
</html>
